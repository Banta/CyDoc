<div style="position: relative">
<div id="invoice">
<div id="info" class="block">
  <h2>Patientenrechnung Nr. <%= @invoice.id %></h2>
  <table>
    <tr>
      <th>Rechnungsdatum:</th><td><%= @invoice.date.strftime('%d.%m.%Y') %></td>
    </tr>
    <tr>
      <th>Behandlungen von:</th><td><%= @invoice.date_begin.strftime('%d.%m.%Y') %></td>
    </tr>
    <tr>
      <th>Behandlungen bis:</th><td><%= @invoice.date_end.strftime('%d.%m.%Y') %></td>
    </tr>
  </table>
</div>

<div id="biller" class="block">
  <h3>Rechnungssteller</h3>
  <%= full_address(@invoice.biller.vcard) %>
  <br/>
  <%= contact(@invoice.biller.vcard) %>
</div>

<div id="referrer" class="block">
<h3>Zuweisender Arzt</h3>
  <%= full_address(@invoice.referrer.vcard) %>
  <br/>
  <%= contact(@invoice.referrer.vcard) %>
</div>

<div id="provider" class="block">
<h3>Leistungserbringer</h3>
  <%= full_address(@invoice.provider.vcard) %>
  <br/>
  <%= contact(@invoice.provider.vcard) %>
</div>

<div id="patient" class="block">
<h3>Patient</h3>
  <%= full_address(@invoice.patient.vcard) %>
  <br/>
  Geburtsdatum <%= @invoice.patient.birth_date.strftime('%d.%m.%Y') if @invoice.patient.birth_date %>			
</div>

<div id="billingaddress" class="block">
  <%= full_address(@invoice.patient.vcard) %>
</div>

<div style="position: absolute; top: 11cm; width: 16.2cm; left: 1.5cm;">
  <%= render :partial => 'insurance_recipe_balance' %>
</div>

<%
@bank_account = @invoice.biller.account
%>

<div id="paymentfor1" class="block">
<%= @bank_account.bank.vcard.full_name %><br />
<%= @bank_account.bank.vcard.postal_code %> <%= @bank_account.bank.vcard.locality %><br />
<div style="font-size: 80%; margin-top: 0.2cm">Zugunsten von</div>
  <%= full_address(@bank_account.holder.vcard) %>
</div>

<div id="account1" class="line"><%= @bank_account.pc_id %></div>
<div id="paymentamount1" class="line"><%= sprintf('%.0f', @invoice.amount.floor) %>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<%= sprintf('%02i', @invoice.rounded_amount * 100 % 100) %></div>
<div id="paymentreference1" class="line"><%= @invoice.esr9_reference(@bank_account) %></div>
<div id="paymentby1" class="block"><%= full_address(@invoice.patient.vcard) %></div>

<div id="paymentfor2" class="block">
<%= @bank_account.bank.vcard.full_name %><br />
<%= @bank_account.bank.vcard.postal_code %> <%= @bank_account.bank.vcard.locality %><br />
<div style="font-size: 80%; margin-top: 0.2cm">Zugunsten von</div>
  <%= full_address(@bank_account.holder.vcard) %>
</div>

<div id="account2" class="line"><%= @bank_account.pc_id %></div>
<div id="paymentamount2" class="line"><%= sprintf('%.0f', @invoice.amount.floor) %>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<%= sprintf('%02i', @invoice.rounded_amount * 100 % 100) %></div>
<div id="paymentby3" class="block"><%= full_address(@bank_account.holder.vcard) %></div>
<div id="reference" class="line"><%= @invoice.esr9_reference(@bank_account) %></div>
<div id="vesr"><%= @invoice.esr9(@bank_account) %></div>
</div>
<div>
